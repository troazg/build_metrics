<div class="row">
  <div class="col-md-6 mx-auto">
    <div>
      <h3 class="text-center">2FA Check</h3>
      <form>
        <div class="form-group">
          <label for="code">Enter Code</label>
          <input type="text" name="code" id="code" class="form-control" autocomplete="off" required>
        </div>
        <button id="submitG2FA" class="btn btn-primary">Submit</button>
      </form>
    </div>
  </div>
</div>

<script type="text/javascript">
  var submitG2FA = document.getElementById('submitG2FA');
  submitG2FA.onclick = function() {
    var code = document.getElementById('code').value;
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/users/loginG2FA', true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.onreadystatechange = function() {
    if (xhr.readyState == 4 && xhr.status == 200) {
      window.location = '/';
    } else if (xhr.readyState == 4 && xhr.status !== 200) {
      window.location = '/users/logout';
    }
    }
    xhr.send('code='+code);
  }
</script>
